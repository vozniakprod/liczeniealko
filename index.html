<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Liczenie alkoholu</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.css" rel="stylesheet" />
  <style>
    .item-row { gap: .5rem; }
    .item-name { max-width: 60%; }
    input.counter-input { font-size: 16px; -webkit-text-size-adjust: 100%; }
    .table-wrap { overflow-x: auto; }
    .accordion-panel, #accordion [data-accordion-target], #accordion h2 button { background-color: #fff !important; color: #111827 !important; }
    .accordion-panel * { background-color: inherit !important; color: inherit !important; }
    button:focus, input:focus { outline: none !important; box-shadow: none !important; }
    .dec-btn, .inc-btn { touch-action: manipulation; -ms-touch-action: manipulation; }
    input.counter-input::-webkit-outer-spin-button, input.counter-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
  </style>
</head>
<body class="bg-gray-100 p-4">
  <div class="max-w-md mx-auto bg-white p-4 rounded-lg shadow">
    <h1 class="text-2xl font-bold mb-4 text-center">Liczenie alkoholu</h1>

    <div id="accordion" data-accordion="collapse" class="divide-y divide-gray-200"></div>

    <div class="mt-6 table-wrap">
      <h2 class="text-xl font-semibold mb-2">PODSUMOWANIE</h2>
      <table class="min-w-full divide-y divide-gray-200 text-sm">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-3 py-2 text-left font-medium">Alkohol</th>
            <th class="px-3 py-2 text-right font-medium">Łącznie</th>
          </tr>
        </thead>
        <tbody id="total-tbody" class="bg-white divide-y divide-gray-100"></tbody>
      </table>
      <button id="copyNumbers" class="mt-3 px-4 py-2 bg-blue-600 text-white rounded-lg">Kopiuj liczby do Excela</button>
    </div>

    <button id="clearStorage" class="mt-6 w-full px-4 py-2 bg-red-600 text-white rounded-lg">Wyczyść dane</button>
  </div>

  <script>
    const locations = ["Bar 0","Bar 2","Gold","Bar Alkoholowy","Pomieszczenie koordynatorskie"];
    const items = [
  "Eisberg Sauvignon Blanc",
  "Ferejean",
  "Jean de la fontane",
  "Val d oca Prosecco Brut",
  "Solaris Białe Skały",
  "Twin Vines Verde",
  "Crama Regala Chardonnay",
  "Hugel",
  "Solaris X",
  "Lipowiec",
  "Malborough Sun",
  "Szlachetny Zbiór turnau",
  "Purcari Freedom Blend",
  "Vinaria Din Vale Feteasca Neagra",
  "Almarosa Primitivo",
  "The Gaucho",
  "Finca Museum Crianza",
  "Kendermann Pinot Noir",
  "Sexton",
  "Soutern Comfort",
  "Famous Grouse",
  "Famous Grouse Ruby",
  "Loch Lomond Original Single Malt",
  "Glen Moray 12yo",
  "Bushmills 10yo",
  "Bushmills",
  "Evan Williams",
  "Buffalo Trace Bourbon",
  "Gautier VS Cognac",
  "Soberano Reserva 5YO",
  "Jose Cuervo Reposado Gold",
  "Jose Cuervo Silver",
  "Kraken",
  "Negrita White",
  "Porto LBV Grahams",
  "Gunpowder",
  "Gibson's London Dry",
  "J.A Baczewski Monopolowa",
  "J.A Baczewski Morelówka",
  "J.A Baczewski Wiśniówka",
  "Krupnik Cappucino",
  "Krupnik pistacja",
  "Bottega Fior de Latte",
  "Bottega Bitter",
  "Carolans",
  "Martini Bianco",
  "Cydr",
  "Żywiec",
  "Heineken",
  "Iquana",
  "Trybunał Export",
  "Trybunał 0%",
  "Trybunał 0% Lemon"
];


    let data = JSON.parse(localStorage.getItem("alcoData")) || {};
    function saveData() { localStorage.setItem("alcoData", JSON.stringify(data)); }

    function updateTotal() {
      const tbody = document.getElementById('total-tbody');
      tbody.innerHTML = '';
      items.forEach(item => {
        let sum = 0;
        locations.forEach(loc => { sum += (data[loc]?.[item] || 0); });
        const tr = document.createElement('tr');
        tr.innerHTML = `<td class="px-3 py-2 text-sm">${item}</td><td class="px-3 py-2 text-sm text-right">${sum}</td>`;
        tbody.appendChild(tr);
      });
    }

    function renderAccordion() {
      const accordion = document.getElementById('accordion');
      accordion.innerHTML = '';
      locations.forEach((loc,i)=>{
        if(!data[loc]) data[loc]={};
        const itemId=`loc-${i}`;
        const section=document.createElement('div');
        section.className='py-1';
        section.innerHTML=`<h2 id="heading-${i}"><button type="button" class="flex w-full items-center justify-between p-3 text-left font-medium" data-accordion-target="#${itemId}" aria-expanded="false" aria-controls="${itemId}"><span>${loc}</span><svg class="w-3 h-3 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></h2><div id="${itemId}" class="hidden p-2 accordion-panel" aria-labelledby="heading-${i}"><ul class="space-y-2"></ul></div>`;
        accordion.appendChild(section);
        const list=section.querySelector('ul');
        items.forEach((item,j)=>{
          if(typeof data[loc][item]!=='number') data[loc][item]=0;
          const inputId=`q-${i}-${j}`;
          const li=document.createElement('li');
          li.className='item-row flex items-center justify-between';
          li.innerHTML=`<span class="item-name text-sm">${item}</span><div class="relative flex items-center max-w-[8rem]"><button type="button" data-dec="${inputId}" class="dec-btn bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded-s-lg p-3 h-11" aria-label="decrement-${inputId}"><svg class="w-3 h-3 text-gray-900" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 2"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h16"/></svg></button><input type="text" inputmode="numeric" pattern="[0-9]*" id="${inputId}" class="counter-input bg-gray-50 border-x-0 border-gray-300 h-11 text-center text-gray-900 text-base block w-16 py-2.5" value="${data[loc][item]}"><button type="button" data-inc="${inputId}" class="inc-btn bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded-e-lg p-3 h-11" aria-label="increment-${inputId}"><svg class="w-3 h-3 text-gray-900" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 18"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 1v16M1 9h16"/></svg></button></div>`;
          const decBtn=li.querySelector(`[data-dec="${inputId}"]`);
          const incBtn=li.querySelector(`[data-inc="${inputId}"]`);
          const inputEl=li.querySelector('input');
          decBtn.addEventListener('click',()=>{inputEl.value=Math.max(0,(parseInt(inputEl.value)||0)-1);data[loc][item]=parseInt(inputEl.value)||0;saveData();updateTotal();});
          incBtn.addEventListener('click',()=>{inputEl.value=(parseInt(inputEl.value)||0)+1;data[loc][item]=parseInt(inputEl.value)||0;saveData();updateTotal();});
          inputEl.addEventListener('input',()=>{inputEl.value=Math.max(0,parseInt(inputEl.value)||0);data[loc][item]=parseInt(inputEl.value)||0;saveData();updateTotal();});
          list.appendChild(li);
        });
      });
      updateTotal();
    }

    document.addEventListener('DOMContentLoaded',()=>{renderAccordion();});

    document.getElementById('clearStorage').addEventListener('click',()=>{localStorage.removeItem('alcoData');data={};renderAccordion();});

    document.getElementById('copyNumbers').addEventListener('click',()=>{
      const numbers = Array.from(document.querySelectorAll('#total-tbody td:nth-child(2)')).map(td=>td.textContent);
      const csv = numbers.join('\n');
      const textarea = document.createElement('textarea');
      textarea.value = csv;
      document.body.appendChild(textarea);
      textarea.select();
      try { document.execCommand('copy'); alert('Skopiowano liczby do Excela'); } catch(e){ alert('Skopiuj ręcznie: ' + csv); }
      document.body.removeChild(textarea);
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.js"></script>
</body>
</html>

